PS D:\CodeData\VSCodeProject\VTxMus> npm run build

> vtxmus@0.0.0 build
> run-p type-check "build-only {@}" --


> vtxmus@0.0.0 type-check
> vue-tsc --build


> vtxmus@0.0.0 build-only
> vite build

vite v7.3.1 building client environment for production...
✓ 154 modules transformed.
src/components/MusicPlayer.vue:285:39 - error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.

285         audioUrl = decodeURIComponent(urlMatch[1])
                                          ~~~~~~~~~~~

src/components/Playlist.vue:43:24 - error TS2345: Argument of type '{ id: number; name: string; artists: { id: number; name: string; }[]; album: { id: number; name: string; picUrl: string; }; duration: number; } | undefined' is not assignable to parameter of type 'Song'.
  Type 'undefined' is not assignable to type 'Song'.

43   playerStore.playSong(playerStore.playlist[index], index)
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~

src/stores/player.ts:110:14 - error TS2345: Argument of type '{ id: number; name: string; artists: { id: number; name: string; }[]; album: { id: number; name: string; picUrl: string; }; duration: number; } | undefined' is not assignable to parameter of type 'Song'.
  Type 'undefined' is not assignable to type 'Song'.

110     playSong(playlist.value[nextIndex], nextIndex)
                 ~~~~~~~~~~~~~~~~~~~~~~~~~

src/stores/player.ts:120:14 - error TS2345: Argument of type '{ id: number; name: string; artists: { id: number; name: string; }[]; album: { id: number; name: string; picUrl: string; }; duration: number; } | undefined' is not assignable to parameter of type 'Song'.
  Type 'undefined' is not assignable to type 'Song'.

120     playSong(playlist.value[prevIndex], prevIndex)
                 ~~~~~~~~~~~~~~~~~~~~~~~~~

src/stores/player.ts:126:5 - error TS2322: Type 'PlayMode | undefined' is not assignable to type 'PlayMode'.
  Type 'undefined' is not assignable to type 'PlayMode'.

126     playMode.value = modes[(currentModeIndex + 1) % modes.length]
        ~~~~~~~~~~~~~~

src/views/PlayPage.vue:14:32 - error TS2532: Object is possibly 'undefined'.

14           transform: `scaleY(${waveHeights[i - 1] / 100})`
                                  ~~~~~~~~~~~~~~~~~~

src/views/PlayPage.vue:281:41 - error TS2345: Argument of type 'Uint8Array<ArrayBufferLike>' is not assignable to parameter of type 'Uint8Array<ArrayBuffer>'.
  Type 'ArrayBufferLike' is not assignable to type 'ArrayBuffer'.
    Type 'SharedArrayBuffer' is not assignable to type 'ArrayBuffer'.
      Types of property '[Symbol.toStringTag]' are incompatible.
        Type '"SharedArrayBuffer"' is not assignable to type '"ArrayBuffer"'.

281     analyser.value.getByteFrequencyData(dataArray.value)
                                            ~~~~~~~~~~~~~~~

src/views/PlayPage.vue:295:40 - error TS18048: 'value' is possibly 'undefined'.

295       const normalizedValue = Math.pow(value / 255, 0.7) // 使用幂函数平滑
                                           ~~~~~

src/views/PlayPage.vue:324:28 - error TS18048: 'value' is possibly 'undefined'.

324       return Math.max(20, (value / 255) * 100)
                               ~~~~~

src/views/PlayPage.vue:425:27 - error TS18048: 'r' is possibly 'undefined'.

425       const brightness = (r + g + b) / 3
                              ~

src/views/PlayPage.vue:425:31 - error TS18048: 'g' is possibly 'undefined'.

425       const brightness = (r + g + b) / 3
                                  ~

src/views/PlayPage.vue:425:35 - error TS18048: 'b' is possibly 'undefined'.

425       const brightness = (r + g + b) / 3
                                      ~

src/views/PlayPage.vue:428:21 - error TS2322: Type 'number | undefined' is not assignable to type 'number'.
  Type 'undefined' is not assignable to type 'number'.

428       colors.push({ r, g, b, count: 1 })
                        ~

  src/views/PlayPage.vue:418:21
    418     const colors: { r: number; g: number; b: number; count: number }[] = []
                            ~
    The expected type comes from property 'r' which is declared here on type '{ r: number; g: number; b: number; count: number; }'

src/views/PlayPage.vue:428:24 - error TS2322: Type 'number | undefined' is not assignable to type 'number'.
  Type 'undefined' is not assignable to type 'number'.

428       colors.push({ r, g, b, count: 1 })
                           ~

  src/views/PlayPage.vue:418:32
    418     const colors: { r: number; g: number; b: number; count: number }[] = []
                                       ~
    The expected type comes from property 'g' which is declared here on type '{ r: number; g: number; b: number; count: number; }'

src/views/PlayPage.vue:428:27 - error TS2322: Type 'number | undefined' is not assignable to type 'number'.
  Type 'undefined' is not assignable to type 'number'.

428       colors.push({ r, g, b, count: 1 })
                              ~

  src/views/PlayPage.vue:418:43
    418     const colors: { r: number; g: number; b: number; count: number }[] = []
                                                  ~
    The expected type comes from property 'b' which is declared here on type '{ r: number; g: number; b: number; count: number; }'

src/views/PlayPage.vue:537:27 - error TS2345: Argument of type 'Uint8Array<ArrayBufferLike>[]' is not assignable to parameter of type 'BlobPart[]'.
  Type 'Uint8Array<ArrayBufferLike>' is not assignable to type 'BlobPart'.
    Type 'Uint8Array<ArrayBufferLike>' is not assignable to type 'ArrayBufferView<ArrayBuffer>'.
      Types of property 'buffer' are incompatible.
        Type 'ArrayBufferLike' is not assignable to type 'ArrayBuffer'.
          Type 'SharedArrayBuffer' is not assignable to type 'ArrayBuffer'.
            Types of property '[Symbol.toStringTag]' are incompatible.
              Type '"SharedArrayBuffer"' is not assignable to type '"ArrayBuffer"'.

537     const blob = new Blob(chunks)
                              ~~~~~~

src/views/PlayPage.vue:585:32 - error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.

585       const minutes = parseInt(match[1])
                                   ~~~~~~~~

src/views/PlayPage.vue:586:32 - error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.

586       const seconds = parseInt(match[2])
                                   ~~~~~~~~

src/views/PlayPage.vue:587:37 - error TS2532: Object is possibly 'undefined'.

587       const milliseconds = parseInt(match[3].padEnd(3, '0'))
                                        ~~~~~~~~

src/views/PlayPage.vue:589:20 - error TS2532: Object is possibly 'undefined'.

589       const text = match[4].trim()
                       ~~~~~~~~

src/views/PlayPage.vue:650:17 - error TS2532: Object is possibly 'undefined'.

650     if (time >= lyrics.value[i].time) {
                    ~~~~~~~~~~~~~~~

src/components/MusicPlayer.vue:285:39 - error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'string'.
  Type 'undefined' is not assignable to type 'string'.

285         audioUrl = decodeURIComponent(urlMatch[1])
                                          ~~~~~~~~~~~

src/stores/player.ts:110:14 - error TS2345: Argument of type '{ id: number; name: string; artists: { id: number; name: string; }[]; album: { id: number; name: string; picUrl: string; }; duration: number; } | undefined' is not assignable to parameter of type 'Song'.
  Type 'undefined' is not assignable to type 'Song'.

110     playSong(playlist.value[nextIndex], nextIndex)
                 ~~~~~~~~~~~~~~~~~~~~~~~~~

src/stores/player.ts:120:14 - error TS2345: Argument of type '{ id: number; name: string; artists: { id: number; name: string; }[]; album: { id: number; name: string; picUrl: string; }; duration: number; } | undefined' is not assignable to parameter of type 'Song'.
  Type 'undefined' is not assignable to type 'Song'.

120     playSong(playlist.value[prevIndex], prevIndex)
                 ~~~~~~~~~~~~~~~~~~~~~~~~~

src/stores/player.ts:126:5 - error TS2322: Type 'PlayMode | undefined' is not assignable to type 'PlayMode'.
  Type 'undefined' is not assignable to type 'PlayMode'.

126     playMode.value = modes[(currentModeIndex + 1) % modes.length]
        ~~~~~~~~~~~~~~


Found 25 errors.

ERROR: "type-check" exited with 2.
PS D:\CodeData\VSCodeProject\VTxMus> 